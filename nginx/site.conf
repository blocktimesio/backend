server {
    listen 80;
    server_name blocktimes.io www.blocktimes.io;

    charset utf-8;
    client_max_body_size 30m;

    set $ROOT_DIR /var/www/html;

    error_log /var/log/nginx/main-error.log;
    access_log /var/log/nginx/main-access.log;

    location / {
        proxy_pass http://unix:///opt/run/gunicorn.socket;
        include proxy_params;
    }

    location /logs/ {
        proxy_pass  http://kibana:5601/;

        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';
        proxy_set_header Host $host;
        proxy_cache_bypass $http_upgrade;

    }

    location /admin/ {
        alias /var/www/html/admin/;
        try_files $uri$args $uri$args/ /admin/index.html;
    }

    location /media/  {
        root $ROOT_DIR;
        include static_params;
    }

    location /static/  {
        root $ROOT_DIR;
        include static_params;
    }
}